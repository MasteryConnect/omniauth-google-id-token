# OmniAuth::GoogleIdToken

A [omnitauth](https://github.com/omniauth/omniauth) strategy for validating Google ID tokens generated by
Google authentication servers.

This makes use of [google-id-token](https://github.com/google/google-id-token) for validating the ID token.

## Installation

Add this line to your application's Gemfile:

    gem 'omniauth-google-id-token'

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install omniauth-google-id-token

## Usage

You use OmniAuth::GoogleIdToken just like you do any other OmniAuth strategy:

```ruby
use OmniAuth::GoogleIdToken, 'SHAREDSECRET', auth_url: 'http://example.com/login'
```

The first parameter is the shared secret that will be used by the external authenticator to verify
that. You must also specify the `auth_url` option to tell the strategy where to redirect to log
in. Other available options are:

* **algorithm:** the algorithm to use to decode the JWT token. This is `HS256` by default but can
  be set to anything supported by [ruby-jwt](https://github.com/progrium/ruby-jwt)
* **uid_claim:** this determines which claim will be used to uniquely identify the user. Defaults
  to `email`
* **required_claims:** array of claims that are required to make this a valid authentication call.
  Defaults to `['name', 'email']`
* **info_map:** array mapping claim values to info hash values. Defaults to mapping `name` and `email`
  to the same in the info hash.
* **valid_within:** integer of how many seconds of time skew you will allow. Defaults to `nil`. If this
  is set, the `iat` claim becomes required and must be within the specified number of seconds of the
  current time. This helps to prevent replay attacks.

### Authentication Process

When you authenticate through `omniauth-google-id-token` you can send users to `/auth/jwt` and it will redirect
them to the URL specified in the `auth_url` option. From there, the provider must generate a JWT
and send it to the `/auth/jwt/callback` URL as a "jwt" parameter:

    /auth/jwt/callback?jwt=ENCODEDJWTGOESHERE

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request
